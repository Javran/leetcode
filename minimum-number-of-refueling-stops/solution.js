// NOTE: TLE for now.
const {min} = require('underscore')

/**
 * @param {number} target
 * @param {number} startFuel
 * @param {number[][]} stations
 * @return {number}
 */
const minRefuelStops = (target, startFuel, stations) => {
  stations.push([target, 0])
  stations.unshift([0, 0])
  const f = new Array(stations.length)
  f[0] = [startFuel]
  for (let i = 1; i < stations.length; ++i) {
    const nowMap = new Array()
    for (let j = 0; j < i; ++j) {
      // try go from j to i
      const dist = stations[i][0] - stations[j][0]
      f[j].forEach((remain, cnt) => {
        if (remain+stations[j][1] >= dist) {
          const newVal = remain+stations[j][1] - dist
          if ((cnt+1) in nowMap) {
            if (nowMap[cnt+1] < newVal) {
              nowMap[cnt+1] = newVal
            }
          } else {
            nowMap[cnt+1] = newVal
          }
        }
      })
    }
    f[i] = nowMap
  }
  const s = f[stations.length-1]
  if (s.length === 0)
    return -1
  return Number(Object.keys(s)[0]) - 1
}

console.log(minRefuelStops(100, 10, [[10,60],[20,30],[30,30],[60,40]]))

console.log(minRefuelStops(
  1000000,
8900,
[[3784,1700],[4363,7414],[4402,4441],[6244,6086],[6602,6465],[8500,3395],[10083,1222],[10369,3699],[11329,352],[15127,1031],[16665,3144],[17795,8511],[17814,525],[18631,2992],[19033,4021],[20405,6872],[25441,1541],[26355,4519],[26372,3309],[26488,6718],[31901,1974],[35060,3547],[35768,6929],[38984,7678],[39887,7825],[40376,3899],[41522,1684],[41712,5192],[42132,6067],[42970,1386],[43539,3813],[44791,8005],[49950,5783],[51340,8117],[52944,4695],[54164,3517],[54253,841],[54268,4745],[56922,2182],[59247,3348],[59554,3475],[59719,5849],[60083,749],[64542,7106],[66942,3033],[67178,7481],[69669,3746],[74683,4892],[75176,4289],[81114,3217],[83422,7849],[83813,8129],[88064,7159],[91236,7470],[93726,5725],[95473,1216],[95934,5050],[100011,6110],[103261,4425],[110981,5972],[115470,6500],[115965,4201],[116530,3107],[119942,7093],[120094,1606],[121770,6679],[122296,2582],[124517,6117],[127031,6077],[128196,8149],[129977,5270],[132387,3386],[133016,2942],[134284,2778],[135544,8726],[136768,5169],[138264,2142],[138422,563],[142219,7900],[145530,360],[148837,7557],[149313,2877],[152405,900],[154309,1791],[154583,5343],[155301,915],[155853,2520],[158276,5229],[166400,7467],[167025,4284],[167485,4300],[168918,6463],[168986,1576],[169077,4322],[170576,4777],[171107,7222],[171919,295],[172671,4398],[175814,1187],[182638,3710],[184097,6355],[186899,5366],[188715,1438],[190138,8272],[193526,5123],[193964,6776],[200280,7978],[200330,3072],[202275,8871],[209415,5075],[211642,6452],[211699,3831],[213547,4841],[216053,8391],[218104,6902],[219016,8350],[221752,1305],[221834,5555],[222130,7966],[222406,8742],[225404,2061],[228216,8029],[229431,4843],[230351,6055],[230390,7844],[230459,72],[230796,4158],[231920,2630],[232691,7589],[233292,3849],[234644,7373],[234916,2006],[238503,3179],[241818,4230],[245492,5111],[247179,3642],[249057,7341],[249580,1254],[251427,666],[253122,1733],[255171,166],[255804,8317],[257571,7571],[262890,546],[263454,1870],[263626,3123],[264818,1476],[266027,337],[266433,6549],[266642,2789],[268854,5611],[269366,2019],[272692,7910],[278531,5495],[280015,5195],[280533,174],[284755,3069],[289318,8337],[292925,7693],[296749,6082],[298042,8378],[301573,3915],[305883,8801],[308008,8119],[314995,7773],[316137,4729],[317040,6117],[317431,7875],[318267,4518],[322884,8570],[324138,6846],[324902,1543],[325560,2333],[325892,2922],[332517,7036],[335321,7455],[336487,6564],[337171,3087],[339181,3398],[342672,4434],[343872,6649],[344720,6892],[348698,2156],[351724,2400],[353971,4590],[354445,6265],[355515,232],[357524,2799],[358107,6264],[360951,8611],[366453,112],[367082,6524],[367191,2132],[367198,6122],[368688,5051],[371249,2721],[374272,2358],[378103,6846],[378789,1393],[379721,2546],[382751,7134],[384550,2985],[384689,5031],[384783,4532],[389363,5957],[394358,4226],[394566,8813],[396760,1111],[398411,1034],[399809,6595],[400166,6922],[402226,4453],[402329,1342],[402969,8592],[403737,2187],[407124,7952],[409814,3920],[410592,1546],[413976,3861],[420527,5472],[420900,5424],[421115,5371],[428669,2413],[429929,1225],[430926,5756],[431330,1965],[432684,7178],[433800,945],[437696,8620],[438395,5077],[438626,7922],[439663,3595],[439750,8845],[441733,1700],[445507,7389],[447335,1631],[450096,3794],[453526,989],[455435,4777],[459470,2627],[461015,3300],[463127,1475],[464179,5292],[466792,7424],[468971,5911],[475209,6589],[476101,4590],[476765,3181],[479283,4895],[480852,8064],[481524,433],[483783,1164],[484200,4772],[485738,5327],[486823,1433],[487539,2458],[487664,117],[490032,4527],[490039,2811],[491097,277],[491453,515],[492695,5827],[496190,7240],[497738,5705],[499056,1781],[500944,1021],[501340,7278],[502672,2842],[504101,1340],[504157,1809],[504318,1223],[507720,8507],[508703,1633],[509545,3755],[510945,7959],[513478,3848],[514691,770],[527962,4327],[530149,5798],[531220,5003],[532715,8162],[536003,3301],[538477,8566],[540306,5027],[541172,5442],[542696,2081],[549229,2496],[551775,1389],[551814,8506],[551844,6199],[555318,7131],[560009,6203],[563258,6887],[563444,4290],[566484,2888],[568333,3884],[568541,6245],[569790,889],[571009,2333],[574182,2475],[576204,3624],[576964,4666],[591294,1341],[596171,2780],[596273,8249],[598540,8363],[599966,8238],[605612,1573],[606080,4289],[608053,4410],[608233,7422],[609469,6486],[613814,1838],[617920,4191],[618107,5021],[623546,6576],[628135,5136],[629010,4913],[633473,8421],[633679,1903],[633961,626],[636337,3535],[636406,2792],[636911,5522],[637367,6682],[638103,5493],[638603,5193],[638911,2102],[644804,5383],[650166,903],[653343,3923],[657588,3337],[664257,7357],[665856,2194],[666576,2422],[668432,1681],[668713,2641],[671478,6555],[672658,2912],[673915,308],[676413,1618],[680853,7544],[683342,4687],[690556,7071],[693248,8395],[693872,8732],[694258,8816],[695137,4477],[695628,1878],[697307,3959],[697315,52],[702952,4725],[704077,420],[712075,405],[715419,5961],[715523,7042],[717267,5927],[718743,6795],[722904,3318],[723002,154],[725300,3245],[725556,8288],[726462,7995],[730670,3964],[731754,515],[735223,4491],[735574,2466],[737911,4030],[738717,442],[740138,7135],[742712,6582],[743680,6533],[745858,4910],[746403,3282],[750218,2903],[751323,675],[756449,4257],[757229,589],[759846,459],[764509,6438],[765303,4885],[766724,2920],[767197,3806],[767456,2087],[768276,348],[771507,3925],[772743,8143],[775591,3977],[775822,3790],[778497,1145],[780478,1321],[782917,8671],[786788,3203],[787224,7308],[788554,4594],[791963,3717],[795541,6823],[795598,1871],[797023,3452],[800698,3241],[802616,7265],[806962,1738],[808826,1118],[811267,6340],[813156,3606],[813259,8388],[814661,4433],[815895,8561],[820004,2408],[820733,6206],[822990,4968],[823605,3174],[824693,6749],[826082,5381],[826777,6581],[827059,6261],[827129,659],[829517,6762],[837221,967],[840394,2369],[840525,6926],[842584,3848],[844398,840],[845932,7189],[847144,5142],[850228,4271],[851755,5971],[855662,3616],[856273,3417],[857307,6786],[860692,2571],[863226,1196],[875408,7378],[882762,7452],[882962,7978],[885088,6504],[888540,3474],[889295,8545],[890297,6758],[890584,4491],[890653,2425],[893937,5245],[894612,1679],[895745,7065],[899924,4441],[899978,8799],[900561,7566],[900792,3021],[901599,3158],[902515,1214],[902769,8579],[903386,276],[903443,6845],[905387,5216],[908392,2162],[911485,7197],[912345,2014],[916856,1042],[917657,4150],[920276,7214],[921794,2494],[926903,8127],[927880,8503],[928720,1715],[930144,2707],[931662,384],[931844,2566],[933018,1657],[938560,152],[941288,6093],[941766,7822],[941893,422],[944970,237],[945828,7277],[946067,3473],[948808,2410],[949794,6162],[951465,5964],[952599,2841],[956908,8568],[959642,350],[960868,7787],[966769,2347],[968510,8052],[970163,2300],[970175,7340],[976747,4337],[979283,4500],[980116,8004],[980763,2788],[981876,6537],[981902,5484],[985188,4902],[988304,6309],[988521,3454],[988657,6597],[989020,677],[992869,6504],[992935,4115],[996353,6850]]
))
